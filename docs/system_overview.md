# 二、系统概述

## 2.1 总体架构设计

NLP-SecLogAI采用模块化的多层架构设计，系统整体架构如下图所示：

```
┌─────────────────┐         ┌─────────────────┐         ┌─────────────────┐
│                 │         │                 │         │                 │
│  日志收集层       │ ───────▶│  处理分析层      │ ───────▶│  展示交互层       │
│                 │         │                 │         │                 │
└─────────────────┘         └─────────────────┘         └─────────────────┘
        ▲                           │                           │
        │                           ▼                           ▼
┌─────────────────┐         ┌─────────────────┐         ┌─────────────────┐
│                 │         │                 │         │                 │
│  数据源接口       │         │  存储层          │◀────────│  API服务层       │
│                 │         │                 │         │                 │
└─────────────────┘         └─────────────────┘         └─────────────────┘
```

### 架构层次说明：

1. **日志收集层**：负责从各种来源收集安全日志数据，包括文件导入、网络接收（Syslog）、API提交和代理程序采集等方式。

2. **处理分析层**：系统的核心部分，包含日志解析器、NLP处理引擎、异常检测算法、机器学习模型和威胁情报整合等模块。

3. **存储层**：采用混合存储策略，包括关系型数据库（用户数据、配置信息）、文档型数据库（日志和分析结果）。

4. **API服务层**：提供RESTful API接口，支持外部系统集成、数据查询、分析结果获取和配置管理等功能。

5. **展示交互层**：基于Web的用户界面，提供仪表盘和可视化、报告生成、告警管理和用户配置等功能。

### 关键组件关系：

```
┌──────────────────┐     ┌──────────────────┐     ┌──────────────────┐
│   LogCollector   │────▶│   LogProcessor   │────▶│ AnomalyDetector  │
└──────────────────┘     └──────────────────┘     └──────────────────┘
         │                        │                        │
         ▼                        ▼                        ▼
┌──────────────────┐     ┌──────────────────┐     ┌──────────────────┐
│  DatabaseService │◀───▶│    NLPEngine     │◀───▶│ ThreatIntelligence│
└──────────────────┘     └──────────────────┘     └──────────────────┘
         ▲                        ▲                        ▲
         │                        │                        │
         ▼                        ▼                        ▼
┌──────────────────┐     ┌──────────────────┐     ┌──────────────────┐
│    APIService    │◀───▶│   AlertManager   │◀───▶│  ReportGenerator │
└──────────────────┘     └──────────────────┘     └──────────────────┘
         │                        │                        │
         └────────────────────────┼────────────────────────┘
                                  ▼
                         ┌──────────────────┐
                         │   WebInterface   │
                         └──────────────────┘
```

## 2.2 系统边界与模块划分

NLP-SecLogAI系统划分为以下主要模块：

### 1. 日志采集与预处理模块
- **功能范围**：负责接收、解析和标准化来自不同来源的安全日志
- **系统边界**：从外部接收各种格式的日志，输出标准化的结构化日志
- **子模块**：
  - 日志收集器（多格式支持）
  - 日志解析器（各类日志格式解析）
  - 日志标准化处理器

### 2. NLP分析引擎模块
- **功能范围**：应用NLP技术分析日志内容，提取关键信息
- **系统边界**：接收标准化日志，输出结构化的日志特征和语义信息
- **子模块**：
  - 文本预处理
  - 实体识别
  - 关键信息提取
  - 语义分析

### 3. 异常检测模块
- **功能范围**：基于规则和AI方法检测异常日志和行为模式
- **系统边界**：接收处理后的日志和特征，输出异常检测结果
- **子模块**：
  - 规则检测引擎
  - AI模型检测
  - 行为分析
  - 威胁情报整合

### 4. 存储管理模块
- **功能范围**：管理系统的所有数据存储需求
- **系统边界**：处理数据存取请求，管理数据生命周期
- **子模块**：
  - 关系型数据管理
  - 查询优化
  - 数据备份与归档

### 5. API服务模块
- **功能范围**：提供REST API接口供内部和外部系统调用
- **系统边界**：接收API请求，返回处理结果
- **子模块**：
  - 日志API
  - 分析API
  - 异常检测API
  - 管理API

### 6. Web界面模块
- **功能范围**：提供用户交互界面
- **系统边界**：展示系统数据和分析结果，接收用户输入
- **子模块**：
  - 仪表盘
  - 日志浏览
  - 告警管理
  - 报告生成
  - 系统配置

## 2.3 关键技术选型与理由

### 1. 开发语言
- **选型**：Python 3.8+
- **理由**：
  - 丰富的数据处理和NLP库生态
  - 开发效率高，适合快速迭代
  - 科学计算和机器学习支持完善
  - 跨平台兼容性好

### 2. Web框架
- **选型**：Flask
- **理由**：
  - 轻量级框架，灵活适应各种需求
  - 模块化设计，便于扩展
  - 完善的文档和社区支持
  - 易于集成各种Python库

### 3. 数据库
- **选型**：SQLite（开发阶段）/ PostgreSQL（生产环境）
- **理由**：
  - SQLite：无需单独服务器，便于开发和测试
  - PostgreSQL：成熟的关系型数据库，性能优良，支持复杂查询
  - 两者迁移路径明确，便于从开发环境转向生产环境

### 4. NLP工具库
- **选型**：NLTK, spaCy
- **理由**：
  - NLTK：功能全面，学术支持良好
  - spaCy：性能优秀，工业级应用支持
  - 两者结合使用，互补优势

### 5. 异步处理框架
- **选型**：Celery + Redis/RabbitMQ
- **理由**：
  - 支持异步任务处理，避免阻塞主流程
  - 可扩展的分布式架构
  - 可靠的任务队列和结果存储
  - 良好的监控和错误处理机制

### 6. 前端技术
- **选型**：Vue.js + Element UI
- **理由**：
  - 响应式设计，用户体验良好
  - 组件化开发，便于维护
  - 丰富的UI组件库
  - 与后端API集成简单

### 7. 认证与授权
- **选型**：JWT (JSON Web Token)
- **理由**：
  - 无状态认证，减轻服务器负担
  - 安全性高，支持签名验证
  - 便于在分布式系统中使用
  - 易于集成到现有框架中

## 2.4 系统运行环境要求

### 硬件要求

#### 开发/测试环境
- **处理器**：Intel Core i5/i7 或同等性能处理器
- **内存**：至少8GB RAM，推荐16GB+
- **存储**：至少50GB可用空间，SSD优先
- **网络**：稳定的互联网连接

#### 生产环境
- **处理器**：至少4核心，建议8核心以上
- **内存**：至少16GB RAM，推荐32GB+
- **存储**：根据日志保留策略，通常需要500GB+，支持扩展
- **网络**：千兆以太网，冗余连接

### 软件要求

#### 操作系统
- **Linux**：Ubuntu 20.04+, CentOS 8+, 或其他主流发行版
- **Windows**：Windows 10/11, Windows Server 2019+（支持但不推荐用于生产环境）
- **macOS**：Catalina (10.15) 或更高版本（仅支持开发环境）

#### 支持软件
- **Python**：3.8或更高版本
- **数据库**：SQLite 3.30+（开发），PostgreSQL 12+（生产）
- **Web服务器**：Nginx 1.18+（生产环境推荐）
- **消息队列**：Redis 6+或RabbitMQ 3.8+
- **容器化**：Docker 19+, Docker Compose 1.25+（可选）

#### 浏览器兼容性
- **Chrome** 80+
- **Firefox** 75+
- **Safari** 13+
- **Edge** 80+
- **不支持** Internet Explorer

### 网络要求
- 开放HTTP(S)端口（80/443）用于Web访问
- 如使用分布式部署，需确保组件间网络连通性
- 可选：出站互联网连接用于威胁情报更新

### 安全要求
- HTTPS证书（生产环境必须）
- 防火墙规则限制仅允许必要端口访问
- 网络隔离保护数据库和内部组件
- 定期安全更新和补丁管理

### 容量规划
- 能够处理每秒约1000条日志记录
- 支持至少10TB的历史日志数据
- 支持100个并发用户访问
- 单次查询响应时间<2秒（标准查询） 