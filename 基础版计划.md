# **基于 NLP 的安全日志分析与异常检测 - 基础版 MVP**  

---

## **1. 项目概述**  
### **1.1 背景**  
企业和组织每天都会产生大量的安全日志（如系统日志、网络设备日志），但传统日志分析系统大多依赖**手动规则匹配**，难以适应不断变化的攻击模式。**本项目使用 NLP 技术**，让系统能够自动解析日志，**智能查询和检测异常**，降低安全团队的工作量，提高检测效率。  

### **1.2 目标**  
在**2 周内完成基础版 MVP**，实现一个**可用的日志分析系统**，包括：

✅ **日志解析**（从文本提取结构化信息）  
✅ **自然语言查询**（让用户用普通语言搜索日志，无需 SQL）  
✅ **异常检测**（发现可疑登录、暴力破解等安全事件）  
✅ **Web 界面**（支持日志上传、查询、简单可视化）  

> 🎯 **可选高级功能**（2 周内有时间可做，易拓展）  
> - **告警系统**（自动通知可疑事件）  
> - **智能摘要**（GPT 生成安全事件总结）  
> - **高级异常检测**（结合深度学习模型）

---

## **2. 系统架构（基础版）**
**技术栈**：
- **前端**：HTML + Bootstrap + jQuery（简单易用）
- **后端**：Flask + SQLite（轻量级、易开发）
- **NLP 处理**：NLTK / spaCy（高效文本解析）
- **日志存储**：SQLite（单机版，支持小规模数据）
- **异常检测**：简单规则匹配 + 机器学习（逻辑回归）

**系统流程**：
1. 用户上传安全日志（支持 TXT / CSV）。
2. Flask 解析日志，将其转换为结构化数据（存入 SQLite）。
3. 用户在 Web 界面输入自然语言查询（如 “过去 24 小时 admin 登录失败次数”）。
4. NLP 模型将查询转换为 SQL，返回结果。
5. 运行简单的异常检测（检测暴力破解、异常 IP 登录等）。
6. 结果展示在 Web 页面上，并支持导出。

---

## **3. MVP 主要功能**
### **📌 3.1 日志解析**
**✅ 基础版：**
- **支持 TXT / CSV 格式**  
- **解析常见日志（Syslog、Web 访问日志、Windows 事件日志）**  
- **提取关键信息**（时间、IP 地址、事件类型、用户名等）  

📌 **示例**
```
2025-03-24 12:34:56 - User 'admin' login failed from 192.168.1.100
```
✅ **转换为 JSON 结构**：
```json
{
    "timestamp": "2025-03-24 12:34:56",
    "username": "admin",
    "event": "login_failed",
    "ip_address": "192.168.1.100"
}
```

🛠 **可选高级功能**（易拓展）：
- **支持更多日志格式**（Firewall logs, Cloud logs）。
- **日志分类**（自动标记哪些是重要日志）。
- **自动清理无用日志**（过滤无关数据）。

---

### **📌 3.2 自然语言查询**
**✅ 基础版：**
- **支持简单查询**（如“过去 24 小时 admin 登录失败次数”）。
- **NLP 将用户查询转换为 SQL**（基于 GPT-4 / 规则匹配）。
- **返回符合条件的日志数据**。

📌 **示例**
```
用户输入：最近 24 小时 admin 失败登录有多少次？
```
✅ **转换成 SQL**
```sql
SELECT COUNT(*) FROM logs 
WHERE username='admin' AND event='login_failed' 
AND timestamp >= datetime('now', '-1 day');
```
✅ **返回结果**
```
过去 24 小时内，admin 登录失败 34 次，涉及 5 个不同 IP。
```

🛠 **可选高级功能**（易拓展）：
- **模糊查询**（“最近几天异常登录” → 自动推测查询范围）。
- **更复杂的查询优化**（支持嵌套查询、联合查询）。
- **支持语音输入**（可选）。

---

### **📌 3.3 异常检测**
**✅ 基础版：**
- **基于规则匹配检测常见攻击**：
  - **暴力破解**（短时间内多次失败登录）。
  - **异常 IP 登录**（从新国家/地区登录）。
  - **特定关键字检测**（如“root 登录失败”）。
- **设置异常阈值**，例如：
  - **如果某个 IP 24 小时内失败登录超过 10 次，标记为“可能的暴力破解”**。

📌 **示例**
```
IP 192.168.1.100 在 5 分钟内尝试了 50 次 admin 登录失败。
```
✅ **系统返回**
```
⚠️ 可能的暴力破解攻击！IP: 192.168.1.100
```

🛠 **可选高级功能**（易拓展）：
- **机器学习模型**（支持自动学习异常模式）。
- **结合威胁情报**（检查 IP 是否在黑名单中）。
- **动态告警优化**（AI 自动调整异常检测阈值）。

---

### **📌 3.4 Web 界面**
**✅ 基础版：**
- **上传日志文件**（支持 TXT / CSV）。
- **搜索日志**（支持普通查询 & 自然语言查询）。
- **异常检测结果展示**（用颜色区分正常 / 异常日志）。

📌 **示例界面**
```
+------------------------------------------------+
| 🔍 日志查询                                     |
+------------------------------------------------+
| 过去 24 小时 admin 登录失败次数：34 次           |
| 可能的暴力破解攻击（192.168.1.100）⚠️           |
+------------------------------------------------+
```

🛠 **可选高级功能**（易拓展）：
- **数据可视化**（折线图、柱状图展示攻击趋势）。
- **导出查询结果**（支持 PDF / Excel）。
- **多用户管理**（不同权限查看不同日志）。

---

## **4. 2 周开发计划**
| **日期** | **任务** | **负责人** |
|----------|----------|-----------|
| **Day 1** | 项目初始化（环境配置、数据库搭建） | 全体成员 |
| **Day 2** | **日志解析模块**（支持 TXT / CSV） | 后端开发 |
| **Day 3** | **NLP 处理（简单 SQL 生成）** | AI 开发 |
| **Day 4** | **异常检测（暴力破解 / 异常 IP 识别）** | 后端开发 |
| **Day 5** | **前端 Web UI（日志查询 + 搜索框）** | 前端开发 |
| **Day 6-7** | **API 对接 + MVP 初步测试** | 全体成员 |
| **Day 8** | **优化异常检测规则** | 后端开发 |
| **Day 9** | **优化自然语言查询（语法改进）** | AI 开发 |
| **Day 10-11** | **系统测试 & 调试** | 全体成员 |
| **Day 12-14** | **编写文档、PPT，准备演示** | 全体成员 |

---

## **5. 结论**
✅ **基础版 MVP** 可在 2 周内完成，提供核心日志解析、自然语言查询、异常检测、Web UI。  
✅ **高级功能** 设计为易拓展项，可根据进度灵活实现，如**告警、可视化、深度学习异常检测**。  

🚀 **如果团队确认方向，我可以进一步提供代码模板、数据库设计、API 详细文档！** 💡